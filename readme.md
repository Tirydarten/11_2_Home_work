# Задание

Продолжаем работу над проектом. Необходимо разработать декоратор `log`, который будет автоматически регистрировать детали выполнения функций, такие как время вызова, имя функции, передаваемые аргументы, результат выполнения и информация об ошибках. Это позволит обеспечить более глубокий контроль и анализ поведения программы в процессе ее выполнения.

## Условия домашнего задания

Чтобы справиться с заданиями, проверьте, что вы изучили весь материал урока:

- Посмотрели видео и прочитали конспект.
- Прорешали задания из разделов «Самостоятельная практика».
- Разобрали решения задач по скринкастам в разделе «Подготовка к практике».

## Как сдавать домашнее задание

Домашнее задание сдайте на проверку наставнику ссылкой на pull request.

## Критерии оценки

Наставник примет вашу работу, если в ней соблюдаются следующие условия. Проверьте работу по критериям перед тем, как отправить ее.

### Работа с GitHub

- Домашка сдана через pull request из ветки домашней работы в ветку `develop`.
- В коммиты не добавлены игнорируемые файлы.
- README-файл дополнен информацией о новом функционале.

### Создание декоратора `log`

- Создан модуль `decorators`.
- Реализован декоратор `log`.
- Декоратор может логировать работу функции и ее результат как в файл, так и в консоль.
- Декоратор `log` принимает необязательный аргумент `filename`, который определяет имя файла, в который будут записываться логи.
- Если `filename` не задан, то логи выводятся в консоль.
- Если вызов функции закончился ошибкой, записывается сообщение об ошибке и входные параметры функции.

### Тестирование декораторов

- Написаны тесты к декоратору.
- Функциональный код покрыт тестами на 80% и более.
- При запуске тестов командой `pytest` все тесты завершаются успешно.
- В репозитории есть папка с отчетом покрытия тестами в формате HTML.

### Оформление кода

- При запуске линтера Flake8 выдается не более 5 ошибок.
- Для всех реализованных функций написаны docstring.
- Нейминг функций отвечает правилам оформления кода PEP 8.

### Работа с линтерами и форматерами

- При вызове `isort` форматируется не более 1 импорта.
## Задачи

Не забудьте, что мы работаем по GitFlow. Необходимо создать новую ветку от актуальной версии ветки разработки и выполнять задания в ней.

1. Создайте новый модуль в вашем проекте, который будет называться `decorators`. Этот модуль будет использоваться для размещения декораторов, включая декоратор `log`.

2. Напишите декоратор `log`, который будет автоматически логировать начало и конец выполнения функции, а также ее результаты или возникшие ошибки. Декоратор должен принимать необязательный аргумент `filename`, который определяет, куда будут записываться логи (в файл или в консоль):

   - Если `filename` задан, логи записываются в указанный файл.
   - Если `filename` не задан, логи выводятся в консоль.

3. Логирование должно включать:
   - Имя функции и результат выполнения при успешной операции.
   - Имя функции, тип возникшей ошибки и входные параметры, если выполнение функции привело к ошибке.

### Пример использования декоратора
@log(filename="mylog.txt")
    def my_function(x, y):
        return x + y

my_function(1, 2)

**Ожидаемый вывод в лог-файл `mylog.txt` при успешном выполнении:**
    my_function ок

**Ожидаемый вывод при ошибке:**
    my_function error: тип ошибки. Inputs: (1, 2), {}
Где `тип ошибки` заменяется на текст ошибки.

4. Используйте `pytest` для написания тестов, проверяющих функциональность декоратора. Для тестирования вывода в консоль примените фикстуру `capsys`, которая позволяет перехватывать вывод данных в консоль. Убедитесь, что тесты покрывают различные сценарии использования декоратора, включая успешное выполнение функций и обработку исключений.

### * Дополнительное задание к проекту

Типизируйте написанный код и добейтесь того, чтобы `mypy` при запуске не выдавал ошибок.

Дополнительное задание, помеченное звездочкой, желательно, но не обязательно выполнять.
